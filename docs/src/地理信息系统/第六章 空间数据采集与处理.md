# 空间数据采集与处理

## 数据源的分类

GIS 数据源比较丰富，类型多种多样，通常可以根据数据获取方式或表现形式进行分类。
![GIS数据源分类](/images/geometry/6-空间数据采集与处理/img73.png)
数据源特征
![数据源特征](/images/geometry/6-空间数据采集与处理/img74.png)

空间数据采集与处理的基本流程

不同的数据源，有不同的采集与处理方法，总体上讲，空间数据的采集与处理包含下面所示的基本内容
![数据源特征](/images/geometry/6-空间数据采集与处理/img75.png)

1. 数据源的选择
   地理信息系统管可用的数据源多种多样，进行选择时，应该注意从下面三个方面考虑

- 是否能够满足系统功能的要求
- 所选数据源是否已有使用经验
- 系统成本

2. 采集方法的确定

- 地图数据，扫描矢量化
- 遥感数据影像，摄影测量，遥感图像处理
- 实测数据，全站仪数据采集，GPS 测量等
- 统计数据，键盘输入，扫描仪输入等
- 共享数据，数据交换等
- 多媒体数据
- 文本资料数据。键盘直接输入

3. 数据的编辑和处理
   各种方法所采集的原始空间数据，都不可避免的存在着错误或者误差，属性数据在建库输入时，也难免会存在错误，所以对图形数据和属性数据进行一定的检查、编辑是很有必要的。要求不同，方法也不同，常用方法有：数学基础、数据结构的转换；图形拼接、拓扑生成；数据压缩。

4. 数据质量控制与评价
   无论是何种数据源，使用何种方法进行采集，都不可避免的存在各种类型的误差，而且误差会在数据处理以及系统的各个环节之中累计和传播，对于数据质量的控制和评价是系统有效运行的重要保障和系统分析结果可靠性的前提条件之一。
5. 数据入库
   数据入库就是按照空间数据管理的要求，把采集和处理的成果数据导入到空间数据库中。

空间数据采集

数据采集就是运用各种技术手段，通过各种渠道收集数据的过程。服务于地理信息系统的数据集工作包括两方面的内容：空间数据的采集和属性数据的采集。

- 空间数据采集的方法：野外数据采集、现有地图数字化、摄影测量方法、遥感图像处理方法等
- 属性数据包括采集的过程以及采集后的分类和编码，相应的采集方案：从相关部门的观测、测量数据、各类统计数据、专题调查数据、文件资料数据等渠道获取。此外，遥感图像解译也是属性数据的重要渠道。

野外数据采集
![数据源特征](/images/geometry/6-空间数据采集与处理/img76.png)
数字测记

数字侧记模式使用全站仪或者 GNSS RTK 在实地测定或计算地形、地物特征点的三维坐标，用一起内存器或联机通信的电子收包记录碎部点定位信息，用草图或简码记录其他绘图信息，在室内将测量数据传输到计算机，在数字测图软件的支持下，进行人机交互编辑与处理，得到 DLG、DEM 以及全要素地形图。

根据实地采集数据所用的设备不同，又可进一步分为 全站仪数据侧记模式和 GNSS RTK 数字侧记模式

电子平板测绘

电子平板测绘模式实际上是使用 “全站仪- 便携机-测图软件”在实地进行数据采集与编辑、制图的作业方式。

在该模式中，使用便携机的屏幕模拟测图平板，利用数字测图软件，在野外直接将全站仪测定的碎部点实时传输给便携机并展示绘制到屏幕上，一句测点的连接方式，进行地形、地物要素的矢量化编辑，从而实现测与会的同步，达到 所测即所得的目的。

地图数字化-手扶跟踪数字化
![数据源特征](/images/geometry/6-空间数据采集与处理/img77.png)

摄影测量方法-摄影测量原理

航测上规定当主轴线与铅垂线方向的夹角小于 3 度时为垂直摄影。摄影测量通常采用立体摄影测量方法采集某一地区空间数据，对统一地区同时摄取两张或多张重叠的相片，在室内的光学仪器上火计算机内恢复他们的摄影方位，重构地形 biu 凹面，即把野外的地形表面搬到室内进行观测。
![数据源特征](/images/geometry/6-空间数据采集与处理/img78.png)
航测上对立体覆盖的要求是当飞机沿一条航线飞行时相机拍摄的任意相邻两张像片的重叠度（航向重叠）不少于 55%-65%，在相邻航线上的两张相邻像片的旁向重叠应该保持在 30%。

数字摄影测量方法采集流程
![数据源特征](/images/geometry/6-空间数据采集与处理/img79.png)
遥感图像处理
![数据源特征](/images/geometry/6-空间数据采集与处理/img80.png)
时空大数据采集

定位导航时空大数据采集：目前，最为常见的交通大数据包括 城市出租车轨迹数据、共享单车和公共单车定位数据以及其他公共交通实时监测数据。主要包括车辆轨迹数据和手机信令基站定位数据。

手机信令基站定位数据

手机已经成为人们日常生活中必不可少的通信工具。实际上，手机就是一个传感器，它记录着每一个人每天的日常行为。通过手机信令数据，可以分析人口的迁徙，居民日常活动的呢过信息，不仅如此，厂商还可以通过人们的定位信息，模拟与预测全国范围内不同尺度的人口密度和人口迁徙

互联网大数据采集

基于网络爬虫技术的互联网大数据获取成为大数据采集、应用和分析的一大主流方向。主要包括基础网络时空大数据采集以及基于网页文本的地理信息采集。

物联网-传感器大数据采集

物联网技术是实现智慧城市的主要支撑技术。其目标是将人、物通过传感器互联，从而构建一个人和人、物和物以及人和物之间均相互联系的系统。物联网主要通过各种传感器实现。由于无论是静态的传感器还是动态移动的传感器，都与地理位置和时间强相关，因此，大多数物联网所产生的数据都属于时空大数据，因此也是 GIS 的主要数据源，主要有社会感知大数据采集以及自然环境感知大数据采集。

属性数据采集

- 属性数据包括调查报告、文件、统计数据、实验数据与野外调查的原始记录等，如人口数据、经济数据、土壤成分等
- 对于待输入的属性数据，若数据量较小，可通过键盘直接键入，若数量大，一般使用关系型数据库或文件、表格、数据库导入
- 对于要直接记录到栅格或矢量数据文件中的属性数据，则必须进行编码输入。

数据编辑

图形数据编辑

统建数据采集过程中，认为因素是造成图形数据错误的主要原因
![数据源特征](/images/geometry/6-空间数据采集与处理/img81.png)
图形数据编辑中经常出现的错误

- 伪结点
- 悬挂结点
- 碎屑多边形
- 不正规的多边形
- 规则的人为对象

其他图形数据错误包括遗漏某些实体、重复录入某些实体、图形定位错误等的检查一般可采用如下方法进行：

- 叠合比较法
- 目视检查法
- 逻辑检查法

图形数据编辑

对于检查出的错误，对图形数据编辑是通过向系统发布编辑命令用光标激活来完成的，编辑命令主要有增加数据、删除数据和修改数据三类。编辑的对象是点元、线元、面元记忆目标，编辑工作的完成主要利用 GIS 的图形编辑功能来完成。

属性数据编辑

属性数据校核包括两部分：

- 属性数据与空间数据是否正确关联，标识码是否唯一，不含空值
- 属性数据是否准确，属性数据的值是否超过其取值范围等。

属性数据错误检查

属性数据错误检查可通过以下方法完成：

首先可以利用逻辑检查，检查属性数据的值是否超过其取值范围，属性数据之间或属性数据与地理实体之间是否有换谬的组合。

把属性数据打印出来进行人工校对，这和校核图来检查空间数据准确性相似。

点线拓扑关系的建立

点线拓扑关系的建立方法有两种方案：一种是在图形采集和编辑中实时建立，此时有两个文件表，一个记录结点所关联的弧段，一个记录弧段两端点的结点、

第二种方案是在图形采集与编辑之后，系统自动建立拓扑关系。其基本思想与前面类似，在执行过程中逐渐建立弧段与起终结点和结点关联的弧段表。

数据编辑与拓扑关系

拓扑关系

点线拓扑关系的建立
![数据源特征](/images/geometry/6-空间数据采集与处理/img83.png)

多边形拓扑关系的建立

多边形有 3 终情况：

- 独立多边形，它与其他多边形没有共同边界，如独立房屋，这种多边形可以在数字化过程中直接生成，因为它仅涉及一条封闭的弧段。
- 具有公共边界的简单多边形，在数据采集时，仅输入了边界弧段数据，然后用一种算法自动将多边形的边界聚合起来，简历多边形文件
- 嵌套的多边形，除了要按第二种方法自动建立多边形外，还要考虑多边形内的多边形（也叫做岛）

以第二种情况为例，讨论多边形自动生成的步骤和方法：
1,。 节点匹配。以任一弧段的端点为圆心，以给定容差为半径，产生一个搜索圆，搜索落入该搜索圆内的其他弧段的端点，若有，则取这些端点坐标的平均值作为结点位置，并代替原来各弧段的端点坐标
![数据源特征](/images/geometry/6-空间数据采集与处理/img84.png)
建立结点-弧段拓扑关系。在结点匹配的基础上，对产生的结点进行编号，并产生两个文件表，一个记录结点所关联的弧段，另一个记录弧段两端的结点。
![数据源特征](/images/geometry/6-空间数据采集与处理/img85.png)
多边形的自动生成，实际上是指建立多边形与弧段的关系，并将弧段关联的左右多边形填入弧段文件中。简历多边形拓扑关系时，必须考虑弧段的方向性，即弧段沿起结点出发，到终结点结束，沿该弧段前进方向，将起关联的两个多边形定义为左多边形和右多边形。

建立多边形拓扑关系的算法：

- 假如从 A4 开始，其起结点为 N4，终结点为 N3，在结点 N3 上，连接的弧段
  分别为 A4、A6、A2，则后续弧段为 A6。
- 沿 A6 向前追踪，其下一结点为 N2,N2 连接的弧段为 A6、A5、A3，后续弧
  段为 A5，A5 的下一结点为 N4。
- 回到弧段追踪的起点，形成一个弧段号顺时针排列的闭合的多边形，该
  多边形一弧段的拓扑关系表建立完毕。在多边形建立过程中，将形成的
  多边形号逐步填入弧段一多边形关系表的左、右多边形内。

网络拓扑关系的建立

网络拓扑关系的建立主要是确定结点与弧段之间的拓扑关系，这一工作可以由 GIS 软件自动完成，其方法与建立多边形拓扑关系时相似，只是不需要建立多边形。但在一些特殊情况下，两条相互交叉的弧段在交点处不一定需要结点，如道路交通中的立交桥，两条相互交叉的弧段在交点处不一定需要节点，如道路交通中的立交桥，在平面上香蕉，但实际上不联通，这时需要手工修改，将在交叉处连通的结点删除。
![数据源特征](/images/geometry/6-空间数据采集与处理/img86.png)

数学基础变换

几何纠正

由于如下原因，使扫描得到的地形数据和遥感数据存在变形，必须加以纠正

- 地形图的实际尺寸发生变形
- 在扫描过程中，工作人员的操作会产生一定的误差，如扫描时地形图或遥感影像没有被压紧、产生斜置或扫描参数的设置不恰当的呢过
- 遥感影像本身就存在着几何变形
- 地图图幅的投影与其他资料的投影不同，或需要将遥感影像的中心投影或多中心投影转换为正射投影等
- 扫描时受扫描仪幅面大小的影响，有时需要将一副地形图或遥感影像分为几块扫描

地形图纠正

对地形图的纠正，一般采用四点纠正法活逐网格纠正法。

- 四点纠正法：一般是根据选定的数字变换函数，输入需要纠正地形图的图幅行列号、地形图的比例尺、图幅名称等，生成标准图廓，分别采集四个图廓控制点坐标来完成
- 逐网格纠正法：是在 4 点纠正法不能满足精度要求的情况下采用的。这种方法和四点纠正法的不通电就在于采样点数目的不同，他是逐方里网进行的，也就是说，对每一个方里网，都要采点。

遥感影像纠正

遥感影像纠正，一般选用和遥感影像比例尺相近的地形图或正射影像图作为变换标准，选用合适的变换函数，分别在要纠正的遥感影像和标准地形图或正射影像图上采集同名地物点。

坐标变换

坐标变换的实质是建立两个空间参考系之间点的一一对应关系。主要分为：投影变换、仿射变换、相似变换、橡皮拉伸。

投影变换
投影变换必须已知变换前后的两个空间参考的投影参数，然后利用投影公式的正解和烦解算法，推算变化前后两个空间参考系之间点的一一对应函数关系

- 投影变换是坐标变换中精度最高的变换方法
- 栅格单元尺寸大小、分辨率
- 栅格原点
- 栅格的倾角

仿射变换

仿射变换是在不同的方向上进行不同的压缩和扩张，可以将球变为椭球，将正方形变为平行四边形
![数据源特征](/images/geometry/6-空间数据采集与处理/img87.png)

相似变换

相似变换是由一个图形变换为另一个图形，在改变的过程中保持形状不变，大小可以更改。在二维变换中，常见的 3 种相似变换有：平移、旋转、缩放。

橡皮拉伸

橡皮拉伸通过坐标几何纠正来修正缺陷。主要针对几何变形，通常发生在原图上。他们可能由于在地图编绘中的配准缺陷、缺乏大地控制或其他各种原因产生。
![数据源特征](/images/geometry/6-空间数据采集与处理/img88.png)

如图所示，原图层（实心线）被纠正成更精确的目标（虚线）。类似于变换，位移关联点在橡皮伸缩中被用于确定要锁移动的位置。

栅格数据重采样

重采样是栅格数据胡空间分析中处理栅格分辨率匹配问题的常用数据处理的方法。进行空间分析时，用来分析的数据资料由于来源不同，经常要对栅格数据进行几何纠正、旋转、投影变换等处理，在这些处理过程中都会产生重采样问题。因此重采样在栅格数据的处理中占有重要地位。
![数据源特征](/images/geometry/6-空间数据采集与处理/img89.png)

最相邻像元法
![数据源特征](/images/geometry/6-空间数据采集与处理/img90.png)
双线性插值法
![数据源特征](/images/geometry/6-空间数据采集与处理/img91.png)
双三次卷积法
![数据源特征](/images/geometry/6-空间数据采集与处理/img92.png)

数据重构

数据重构主要包括数据结构的转换和数据格式的转换。通用的空间数据结构有栅格和矢量两种，在地理信息系统中，他们之间的相互转换是经常性的。

GIS 在其发展过程中，出现了很多研究机构和企业，他们所使用的数据格式往往不尽相同。为了实现相互之间的数据和资源共享，需要对数据格式进行转换。

数据结构转换包括两部分：`矢量数据向栅格数据的转换`和`栅格数据向矢量数据的转换`。

矢量数据栅格化

矢量数据的基本坐标是直角坐标 x,y，其坐标原点一般取图的左下角。栅格数据的基本坐标时行和列（i，j），其坐标原点一般取图的西南角，两种数据变换时，令直角坐标 x 和 y 分别于行和列平行，按确定的栅格大小采样。

首先需要完成多边形边界线段的栅格化，然后，用面域属性值填充。矢量的面域向栅格转换又称为多边形填充，常用的多边形填充算法有：内部点扩散法、射线法、扫描线法。

- 从图幅西北角开始，按顺时针或逆时针方向，从起始点开始，根据 8 个相邻域进行搜索，依次跟踪相邻点，找出线段经过的栅格
- 将栅格 i，j 坐标变成直角坐标 x，Y
- 生成拓扑关系，对于矢量表示的边界弧段，判断其于原图上各个多边形的空间关系，形成完整的拓扑结构，并建立于属性数据的联系。
- 去除多余点以及曲线圆滑：常用的算法有线性迭代法，分段三次多项式插值法、正轴抛物线平均加权法、斜抛物线平均加权法、样条函数插值法等
- ![数据源特征](/images/geometry/6-空间数据采集与处理/img93.png)

数据格式转换

数据交换模式

- 外部数据交换模式
- 直接数据访问模式
- 数据互操作模式
- 空间数据共享平台模式

数据格式的相互转换是目前可行的方法，数据转换可以分为三类：

- 分层和编码原则都不同的数据转换
- 分层不同，编码原则相同的数据转换
- 分层不同，编码方案完全一致的数据转换

空间数据格式转换的途径有：

- 外部文件交换方式
- 标准空间数据交换方式
- 空间数据互操作方式
- 基于语义数据转换方式

外部文件交换方式

![数据源特征](/images/geometry/6-空间数据采集与处理/img94.png)
标准空间数据交换方式
![数据源特征](/images/geometry/6-空间数据采集与处理/img95.png)

数据压缩

数据压缩是指从取得的数据集合中抽取一个子集，这个子集作为一个新的信息源，在规定的精度范围内最好的逼近原集合，而又取得尽可能大的压缩比。

- 栅格数据压缩技术有 游程编码、四叉树发等
- 矢量数据简化实际上是对原矢量坐标串中的多个矢量点根据线性形态，减少数据点，包括：线实体简化、双线中心线生成、多边形消融、多边形轮廓聚合。

间隔取点法：比较相邻晾特征点的距离与阈值的大小，确定是否保留或舍弃。
![数据源特征](/images/geometry/6-空间数据采集与处理/img96.png)
垂距和偏角法：利用曲线上顺序的 3 点 Pn-1，Pn，Pn+1，将 Pn-1，Pn+1 相连，计算 Pn 到 Pn+1 的垂直距离或 Pn-1Pn 和 PnPn+1 直线的夹角，并规定限差，决定点的取舍。
![数据源特征](/images/geometry/6-空间数据采集与处理/img97.png)

分裂法

1. 把曲线首末两端点连城一条直线
2. 计算曲线上每一个点与直线的垂直距离。若所有这些距离均小于限差，则将直线两端点间的个点全部舍去
3. 若上一步条件不满足，则保留含有最大垂足距离的点，将原曲线分成梁端曲线，再递归的重复使用分裂法。
   ![数据源特征](/images/geometry/6-空间数据采集与处理/img98.png)

空间数据质量评价与控制

- 空间数据质量是指数据对特定用途的分析和操作的使用程度
- 空间数据质量与空间分辨率或制图比例尺相关。

相关概念

- 准确性（accuracy）即一个记录值与他的真实值之间的接近程度
- 数据的精密度（precision）对某一量的多次测量，各观测值的离散程度
- 分辨率（resolution）两个可测量数值之间最小的可辨识的差异。
- 比例尺（scale）地图上两个点间图面距离和他所表现的真实世界的距离之间的一个比值
- 误差（error）表示数据与其真实值之间的差异
- 不确定性（uncertainty）关于空间事物、现象的特征和过程不能被准确的确定的程度
- 偏差

准确性和数据的精密度一般可以合起来成为数据的精确度或者精度
