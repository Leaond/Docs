# 第八章 数字高程模型 DEM

数字高程模型 是通过有限的地形高程数据实现对地形曲面的数字化模拟（即地形表面形态的数字化表示），它是对二维地理空间上具有连续变化特征地理现象的模型化表达和过程模拟。

数字高程模型在数学中被定义为二维空间的连续函数
![数据源特征](/images/geometry/8-数字高程模型/img1.png)

DEM 的扩展
![数据源特征](/images/geometry/8-数字高程模型/img2.png)

数字地面模型有关术语
![数据源特征](/images/geometry/8-数字高程模型/img3.png)

DEM 的类型
![数据源特征](/images/geometry/8-数字高程模型/img4.png)

DEM 的类型

按照数据的组织方式划分

![数据源特征](/images/geometry/8-数字高程模型/img5.png)

按数据的尺度分
![数据源特征](/images/geometry/8-数字高程模型/img6.png)

数字地形分析

数字地形分析(Digital Terrain Analysis, DTA)，是指在数字高程模型上进行地形属性和特征提取的数字信息处理技术。

DTA 技术是各种与地形因素相关空间模拟技术的基础。

地形属性根据地形要素的关系特征和计算特征，可以归纳为地形曲面参数（parameters）、地形形态特征（features）、地形统计特征（statistics）和复合地形属性（compound attributes）。

地形曲面参数具有明确的数字表达式和物理定义，并可在 DEM 上直接量算，如坡度、坡向、曲率等。

地形形态特征是地表形态和特征的定性表达，可以在 DEM 上直接提取，其特点是定义明确，但边界条件有一定的模糊性，难以用数学表达式表达，如在实际的流域单元的划分中，往往难于确定流域的边界。

地形统计特征是指给定地表区域的统计学上的特征

复合地形属性是在地形曲面参数和地形形态特征的基础上，利用应用科学的应用模型而建立的环境变量，通常以指数形式表达。

数字地形分析的主要内容

- 提取描述地形属性和特征因子，并利用各种相关技术分析解释地貌形态、划分地貌形态等。
- DTM 的可视化分析。

数字地形分析方法
![数据源特征](/images/geometry/8-数字高程模型/img7.png)

1. 提取坡面地形因子

地形定量因子是为有效地研究与表达地貌形态特征所设定的具有一定意义的参数或指标。

从地形地貌的角度考虑，地表是由不同的坡面组成的，而地貌的变化，完全源于坡面的变化。常用的坡面地形因此有坡度、坡向、平面曲率、坡面曲率、地形起伏度、粗糙度、切割深度等。

2. 提取特征地形要素

   1. 流域分析： 流域分析主要是根据地表物质运动的特征，特别是水流运动的特点，利用水流模拟的方法来提取水系、山脊线、谷底线等地形特征线，并通过线状信息分析其面域特征
   2. 可视域分析：可视性分析包括两方面内容：一个是两点之间的通视性（Intervisibility），另一个是可视域（ViewShed），即对于给定的观察点所覆盖的区域

3. 地形统计特征分析：地形统计分析师应用统计方法对描述地形特征的各种可量化的因子或参数进行相关、回归、趋势面、聚类等统计分析，找出各因子或参数的变化规律和内在联系，并选择合适的因子或参数建立地学模型，从更深层次探讨地形演化及其空间变异规律。

## 第二节 DEM 建立

### DEM 建立的一般步骤

数字高程模型的建立过程是一个模型建立过程。从模型论角度讲，就是将源域（地形）表现在另一个域（目标域或 DEM）中的一种结构，`建模的目的是对复杂的客体进行简化和抽象`，并把对客体（源域，DEM 中为地形起伏）的研究转移到对模型的研究上来。

模型建立之初，首先要为模型构造一个合适的空间结构（spatial framework）。空间结构是为把特定区域内的空间目标镶嵌在一起而对区域进行的划分，划分出的各个红箭范围称为位置区域或空间域。空间结构一般是规则的，或不规则的。

构筑模型的一般内容与过程

1. 采用合适的空间模型构造空间结构
2. 采用合适的属性域函数
3. 在空间结构中进行采样，构造空间域函数
4. 利用空间域函数进行分析

DEM 数据模型与数据结构

1. DEM 数据模型：DEM 数据模型是一个地貌的抽象模型，它为地形的存储、处理和应用建立了一个数据记录与组织的基础，一个 DEM 的数据模型明确的决定了 DEM 数据的结构
2. DEM 数据结构：DEM 数据结构是在计算机中存储与组织表面高程数据的特定方法，因此它能够有效的使用。

DEM 数据模型与数据结构
![数据源特征](/images/geometry/8-数字高程模型/img8.png)

### 格网 DEM 的建立

规则网格（Regular Grid-Based DEM）：地形表面被分为一系列的网格单元，每个网格存储一个高程值。
![数据源特征](/images/geometry/8-数字高程模型/img9.png)

特点：

- 简单存储结构，二维矩阵
- 易于与 RS 图像结合
- 数据冗余
- 不能明确表达地形结构的详细信息

存储结构

- 直接
- 压缩

- 栅格数据结构中，数据被存储在网格的行列中
- 行列相交的栅格单元带有其属性值
- 每个栅格的行列号代表真实地表的位置，而行列号所对应的 Z 值代表高程值或其他的属性值。
  ![数据源特征](/images/geometry/8-数字高程模型/img10.png)

DEM 网格参数：形状、分辨率、位置、方向。
![数据源特征](/images/geometry/8-数字高程模型/img11.png)
![数据源特征](/images/geometry/8-数字高程模型/img12.png)
![数据源特征](/images/geometry/8-数字高程模型/img13.png)
![数据源特征](/images/geometry/8-数字高程模型/img17.png)

DEM 是在二维空间上对三维地形表面的描述。

构建 DEM 的整体思路是首先在二维平面上对研究区域进行格网划分（格网大小取决于 DEM 的应用目的），形成覆盖整个区域的网格空间结构，然后利用分布在网格点周围的地形采样点内插计算格网点的高程值，最后按一定的格式输出，形成改地区的格网 DEM
![数据源特征](/images/geometry/8-数字高程模型/img14.png)

### TIN 的建立

TIN 将离散的点连接成连续的最优结构三角面。

特性：

- 可变的分辨率
- 顾及地形结构
- 存储复杂

三角形作为 TIN 的主要元素，可以通过多种方法构建。这些方法都必须复合一定的剖分准则。

一般必须满足的要求包括：

- 使三角形形状最佳，即尽量接近正三角形
- 保证最近的三个点在同一三角形上
- 三角网络是唯一的（不能出现四点共线）

TIN 三角剖分准则
![数据源特征](/images/geometry/8-数字高程模型/img15.png)
![数据源特征](/images/geometry/8-数字高程模型/img16.png)

Delaunay

### 等高线的建立

等高线 DEM 的建立实际上将数据源转换为特定 DEM 结构的过程。该过程包含了以下几个步骤：首先选取合适的空间模型，如规则网格或不规则网格 TIN；其次，确定空间域函数，即内插函数；最后，利用空间域函数进行分析，即求取指定点上的函数值。

基于 TIN 的等高线生成方法
![数据源特征](/images/geometry/8-数字高程模型/img18.png)

### DEM 内插方法

网格 DEM 的构建方法是将原始离散点转换为规则分布的格网点的数字变换过程。空间内插是构建栅格 DEM 不可或缺的方法。
![数据源特征](/images/geometry/8-数字高程模型/img19.png)
整体内插
![数据源特征](/images/geometry/8-数字高程模型/img20.png)
局部分块内插
![数据源特征](/images/geometry/8-数字高程模型/img21.png)
逐点内插法
![数据源特征](/images/geometry/8-数字高程模型/img22.png)

## 第三节 数字地形分析

### 基本因子分析

![数据源特征](/images/geometry/8-数字高程模型/img23.png)

**坡度**
![数据源特征](/images/geometry/8-数字高程模型/img24.png)

坡度的两种表示方法
![数据源特征](/images/geometry/8-数字高程模型/img25.png)

基于 Grid DEM 提取的坡度图
![数据源特征](/images/geometry/8-数字高程模型/img26.png)

**坡向**
![数据源特征](/images/geometry/8-数字高程模型/img27.png)

**曲率**
![数据源特征](/images/geometry/8-数字高程模型/img28.png)

**地面曲率提取步骤流程图**
![数据源特征](/images/geometry/8-数字高程模型/img28.png)

#### 宏观地形因子

**地形起伏度**

地形起伏度是指在所指定的分析区域内所有栅格中最大高程与最小高程的差。地形起伏度是反映地形起伏的宏观地形因子，在区域性研究中，利用 DEM 数据提取地形起伏度能够直观的反映地形起伏特征。在水土流失研究中，地形起伏度指标能够反映水土流失类型区的土壤侵蚀特征，比较适合区域水土流失评价的地形指标。

**地表粗糙度**

地表粗糙度，一般定义为地表单元的曲面面积 S 曲面与其在水平面上的投影面积 S 水平之比。数学表达式为

```js
R = S曲面 / S水平;
```

地表粗糙度能够反映地形的起伏变化和侵蚀程度的宏观地形因子。在区域性研究中，地表粗糙度是衡量地表侵蚀程度的重要量化指标，在研究水土保持及环境监测时研究地表粗糙度也有很重要的意义。

**地表切割深度**

地表切割深度是指地面某点的领域范围的平均高程与该领域范围内的最小高程的差值。

```js
D(i) = H(mean) - H(min)
```

地表切割深度直观地反应了地表被侵蚀切割的情况，并对这一地学现象进行了量化，是研究水土流失及地表侵蚀发育状况时的重要参考指标，其提取算法可参照地表起伏度的提取。

### 地形特征分析

#### 地形特征点提取

山顶点（peak）、凹陷点（pit）、脊点（ridge）、谷点（channel）、鞍点（pass）、平地点（plane）等
![数据源特征](/images/geometry/8-数字高程模型/img30.png)

#### 地形特征分析

**山脊线和山谷线提取**

山脊线和山谷线提取构成了地形起伏变化的分界线（骨架线）
![数据源特征](/images/geometry/8-数字高程模型/img31.png)

提取方法：

1. 基于图像处理技术的原理
2. 基于地形表面几何形态分析原理
3. 基于地形表面流水物理模拟分析原理
4. 基于地形表面几何形态分析和流水物理模拟分析相组合
5. 平面曲率与坡位结合法

**基于图像处理技术的原理**

边缘提取：

- 首先提取地形特征点，如山脊点、山谷点等
- 将特征点连接成地形特征点，如山脊线、山谷线。

简单移动窗口的算法

- 设计一个 2\*2 窗口以对 DEM 格网阵列进行扫描
- 第一次扫描中，将窗口中的具有最低高程值的点进行标记，自始至终未被标记的点即为山脊线上的点。
- 第二次扫描中，将窗口中的具有最高高程值的点进行标记，自始至终未被标记的点即为山谷线上的点。

**基于地形表面几何形态分析原理**

- 找出 DEM 的纵向与横向的两个断面上的极大、极小值点，作为地形特征线上的备选点。
- 根据一定的条件或准则将这些备选点划归各自所属的地形特征线。

**基于地形表面几何形态分析和流水物理模拟分析相组合**

- 概略 DEM 的建立
- 地形流水物理模拟
- 概略地形特征线提取
- 地形几何分析
- 地形特征线精确确定

**平面曲率与坡位结合法**

- 利用 DEM 数据提取地面的平面曲率，可同时提取得到山脊线和山谷线
- 根据已有的正负地形特征，负地形中的为山谷线，正地形中的为山脊线。

### 流域分析

#### 流域定义

降水汇集在地面低洼处，在重力作用下经常或周期性的沿流水本身所造成的槽型谷地流动，形成所谓的河流。河流沿途接纳很多支流，水量不断增加。干流和支流共同组成水系。每一个河流或每一个水系都从一部分陆地面积上获得补给，这部分陆地面积就是河流或水系的流域，也就是河流或水系在地面的集水区。把两个相邻集水区之间的最高点连接成的不规则曲线，就是两条河流或水系的分水线，因此，流域也可以说是河流分水线以内的地表范围。

#### 流域提取

![数据源特征](/images/geometry/8-数字高程模型/img32.png)
![数据源特征](/images/geometry/8-数字高程模型/img33.png)
![数据源特征](/images/geometry/8-数字高程模型/img34.png)
![数据源特征](/images/geometry/8-数字高程模型/img35.png)
![数据源特征](/images/geometry/8-数字高程模型/img36.png)
![数据源特征](/images/geometry/8-数字高程模型/img37.png)

### 可视性分析

可视性分析也称为透视分析，它实质属于对地形进行最优化处理的范畴。可视性分析的基本因子有两个，一个是两点之间的透视性，另一个是可视域，即对于给定的观察点所覆盖的区域。

可视域分为点到点可视、点到线可视、点到区域可视。
![数据源特征](/images/geometry/8-数字高程模型/img38.png)

#### 判断两点之间的可视性的算法

1. 比较常见的一种算法基本思路如下：① 确定观察点和目标点所在的线段与 XY 平面垂直的平面 S；② 求出地形模型中与平面 S 相交的所有边；③ 判断相交的边是否位于观察点和目标点所在的线段之上，如果有一条边在其上，则观察点和目标点不可视。
2. 另一种算法是“射线追踪法”：这种算啊的基本思想是对于给定的观察点 V 和某个观察方向，从观察点 V 开始沿着观察方向计算地形模型中与射线相交的第一个面元，如果这个面元存在，则不再计算。显然这种方法即可用于判断两点相互间是否可视，又可以用于限定区域的水平可视计算。

#### 计算可视域的算法

基于规则网格 DEM 的可视域算法在 GIS 分析中应用较广。在规则格网 DEM 中，可视域经常是以离散的形式表示，即将每个格网点表示为可视或不可视，这就是可视矩阵。

在 ArcGIS 中分析在某个区域内基于观察点的可视范围。可视区域分析不仅显示了在一个区域内从一个或多个观察点可以观察到的区域范围，而且显示了对于一个可视位置，有多少观察点可以观察到此位置。在输出的 Viewshed 数据中，可视的栅格赋值为 1（深灰色），不可视的栅格赋值为 0（透明）.

### 黄土高原建模与分析
