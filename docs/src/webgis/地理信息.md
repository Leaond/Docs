# 地理信息系统

**地理信息系统（GIS）** 是一种用于采集、存储、分析、管理和展示地理空间数据的计算机系统。它结合了地图学、数据库技术、遥感、空间分析和计算机科学，广泛应用于城市规划、环境监测、灾害管理、交通、农业等领域。

## 空间数据投影

:::info 地图投影的基本问题

在数学中，投影的含义是指建立两个点集之间一一对应的映射关系。同样，在地图学中，地图投影的实质就是按照一定的数学法则，将地球椭球面上的经纬网转换到平面上，建立地面点位的地理坐标（B，L）与地图上相对应的平面直角坐标（X，Y）之间一一对应的函数关系。

在数学上讲，地球表面是一种不可能展开的曲面，要把这样一个曲面表现到平面上，就会发生裂隙或褶皱。运用经纬线的 拉伸或压缩 实现投影，往往会造成地图投影的变形。
:::

### 常用地图投影概述

**高斯-吕克投影**

**高斯-吕克投影**的中央经线和赤道互为垂直的直线，其他经线均为凹向，并对称于中央经线的曲线，其他纬线均是以赤道为对称轴的向两级弯曲的曲线，经纬线成直角相交。
![高斯-吕克投影](/images/geometry/gaosi.png)

常见的投影坐标系

![投影坐标系](/images/geometry/touying.png)

### 空间坐标转换基本概念

空间坐标转换是把空间数据从一种坐标参考系映射到另一种空间参考系中。空间转换有时也称投影变换。投影变换是地图制图的理论基础，主要用来解决换带计算、地图转绘、图层叠加、数据集成等问题。

- 投影转换： 在完成地理坐标值转换的同时，必须完成空间参考框架信息（参考椭球、大地基准面以及投影规则）的精确转换。
- 单纯坐标值的变换：只需要把空间数据的坐标值从一种参考系映射到另一种空间参考系中，转换后的空间参考系信息直接采用目标参考系信息。

### 分辨率

#### 图像分辨率

`图像分辨率表示景物信息的详细程度是衡量遥感或数字图像中景物信息详细程度的关键指标`。 通常分为 `光谱分辨率`、`时间分辨率` 和 `空间分辨率`。不同类型的分辨率从不同维度描述数据的精细度和适用场景。

**空间分辨率**

空间分辨率指图像中单个像素所代表的地面实际尺寸（单位：米/像素），即 地面采样距离（GSD）。数值越小，分辨率越高。
| 分辨率等级 | 典型传感器/卫星 | 适用场景 |  
|------------|----------------|----------|  
| **亚米级**（<1m） | WorldView-3（0.31m）、无人机影像 | 城市规划、军事侦察 |  
| **米级**（1-5m） | SPOT-6/7（1.5m）、GF-2（0.8m） | 地籍测量、灾害评估 |  
| **中分辨率**（5-30m） | Landsat-9（30m）、Sentinel-2（10m） | 农业监测、森林覆盖 |  
| **低分辨率**（>30m） | MODIS（250m-1km）、NOAA-AVHRR | 气象预测、大范围生态研究 |

**光谱分辨率**

指传感器能够捕获的电磁波谱的细分程度，包括波段数量和波段宽度。波段越多、宽度越窄，越能区分地物细微差异。
| 类型 | 波段数量 | 典型传感器 | 应用 |  
|------|----------|------------|------|  
| **全色（Panchromatic）** | 1 个宽波段（450-800nm） | WorldView-3（0.31m） | 高分辨率黑白影像 |  
| **多光谱（Multispectral）** | 4-10 个波段（如红、绿、蓝、近红外） | Landsat-8（11 波段）、Sentinel-2（13 波段） | 植被指数（NDVI）、水体检测 |  
| **高光谱（Hyperspectral）** | 数十至数百个窄波段（5-10nm 宽度） | AVIRIS、PRISMA | 矿物勘探、精准农业 |  
| **超光谱（Ultraspectral）** | 上千个连续波段 | 实验性传感器 | 大气成分分析 |

光谱特征曲线：不同地物在不同波段的反射率差异，用于分类和识别。

**时间分辨率**

指传感器对同一地区重复观测的时间间隔，也称为 重访周期。时间分辨率越高，越适合检测动态变化。
| 卫星/传感器 | 重访周期 | 特点 |  
|-------------|----------|------|  
| **GEO 静止卫星**（如 Himawari-8） | 10 分钟 | 连续监测气象变化 |  
| **低轨卫星**（如 Sentinel-2） | 5 天（双星组网） | 中分辨率多光谱数据 |  
| **Landsat-9** | 16 天 | 长期地表变化研究 |  
| **无人机/航空摄影** | 按需定制 | 应急灾害实时监测 |

#### 地面像元分辨率

地面像元分辨率是遥感、摄影测量和无人机航测中的核心参数，直接决定图像的清晰度和可识别地物的最小尺寸。

GSD：单个像素对应的地面实际尺寸（单位：米/像素），即影像中一个像素点在地面的物理边长。例如：GSD=0.1m 表示 1 个像素覆盖地面 10cm×10cm 的区域。数值越小，分辨率越高（如 0.1m 优于 1m），可识别更小的地物（如车辆 vs.街区）。

## 地理空间与空间实体

`地理空间是地球表层及其周边环境构成的连续三维空间，包含 地理位置（经纬度、高程）、空间关系（距离、拓扑）和 动态变化（时间维度）`。

`空间实体是地理空间中可独立识别的客观对象，具有 几何形态、属性信息 和 空间关系`。

### 地理空间实体及其基本特征

地理空间实体是对复杂地理事物和现象进行简化抽象得到的结果，简称`空间实体`。他们的一个典型特征是与一定的地理空间位置有关，都具有一定的几何形态、分布状况以及彼此之间的相互关系。空间实体具有 4 个基本特征：`空间位置特征`、`属性特征`、`时间特征`、`空间关系特征`。

- 空间位置特征：是表示空间实体在一定的坐标系中的空间位置或几何定位，通常采用地理坐标的经纬度、空间直角坐标、平面直角坐标和极坐标等来表示。空间位置特征也称为几何特征，包括空间实体的位置、大小、形状和状态分布状况等。
- 属性特征：也称为非空间特征或专题特征，是与空间实体相联系的、表征空间实体本身性质的数据或数量，如实体的类型语义定义、量值等。属性通常分为定性和定量两种，定性属性包括名称、类型、特性等；定量属性包括数量、等级等。
- 时间特征：是指空间实体随着时间变化而变化的特性。空间实体的空间位置和属性相对于时间来说，可能会存在空间位置和属性同时变化的情况，如旧城区改造中，房屋密集区拆迁新建商业中心；也存在空间位置和属性独立变化的情况，即实体的空间位置不变，但属性发生变化，如土地使用权转让，或者属性不变而空间位置发生变化，如河流的改道
- 空间关系特征：在地理空间中，空间实体一般都不是独立存在的，而是相互之间存在着密切的联系。这种相互联系的特性就是空间关系。空间关系包括拓扑关系、顺序关系、度量关系等。

### 空间认识和抽象

GIS 对现实世界的抽象：地理信息系统作为对地理空间事物和现象进行描述、表达和分析的计算机系统，首先必须将现实世界描述成计算机能理解和操作的数据形式。

`数据模型是对现实世界进行认知、简化和抽象表达，并将抽象结果组织成有用、能反映现实世界真实状况数据集的桥梁，是地理信息系统的基础`。

由于地理空间事物和现象的复杂性和人们认识地理空间在观念或方法上的不同，地理信息系统对空间实体的抽象方式也存在一定的差别。

## 空间数据概念模型

空间数据概念模型可以分为以下几种：

- 对象模型。例如建筑、树木等设施等
- 场模型。例如污染物扩散、河流淹没等
- 网络模型。例如道路、管道等
- 时空模型。例如车的轨迹、高频次检测数据等
- 多维数据模型

### 概念模型的选择

#### 一、对象模型

对象数据模型也叫做`要素模型`，将研究的整个地理空间看成一个空域，地理现象和空间实体作为独立的对象分布在该空域中。按照其空间特征分为点、线、面、体四种基本对象，对象也可能与其他对象构成复杂对象，并且与其他分离的对象保持特定的关系，如点、线、面、体之间的拓扑关系。每个对象对应着一组相关的属性以及区分各种不同的对象。

**对象模型的适用**

对象模型强调地理空间中的单个地理现象。任何现象，无论大小只要能从概念上与其相邻的其他现象分离开来，都可以被确定为一个对象。对象模型一般适合于对具有明确边界的地理现象进行抽象建模，如建筑物、道路、公共设施和管理区域等人文现象以及胡泊、河流、岛屿和森林等自然现象，因为这些现象可被看做是离散的单个地理对象。

**对象模型的基本表达方式**

对象模型把地理现象当做空间要素或空间实体。一个空间要素必须同时符合 3 个条件：`可被识别`、`在观察中的重要程度`、`有明确的特征且可被描述`。

#### 二、场模型

场数据模型也称作`域模型`，是把地理空间中的现象作为连续的变量或体来看待，如大气污染程度、地表温度、土壤湿度、地形高度以及大面积空气和水域的流速和方向等。

根据不同的应用，场可以表现为二维或三维。一个二维场就是在二维空间 R² 中任意给定的一个空间位置上，都有一个表现某现象的属性值，即 A = f(x,y)。一个三维场是在三维空间 R 中任意给定一个空间位置上，都对应一个属性值。一些现象如大气污染的空间分布本质上是三维的，但为了便于分析和表达，往往采用二维空间来表示。

在不考虑时间变化时，二维空间场一般采用六种具体的场数据模型来描述：

- 规则分布的点
- 不规则分布的点
- 规则矩形区
- 不规则多边形区
- 不规则三角形区
- 等值线
  ![对象模型](/images/geometry/changmodel.png)

#### 三、网络模型

网络数据模型，他与对象模型的某些方面相同，都是描述不连续的地理现象，不同之处在于它需要考虑通过路径相互连接多个地理现象之间的连通情况。网络是由欧式空间中的若干点以及他们之间相互连接的线构成，亦即在地理空间中，通过无数通道相互连接的一组地理空间位置。现实世界许多地理事物和现象可以构成网络，如公路等都可以表示成相应的点之间的连线，由此构成现实世界中多种多样的地理网络。

**网络模型的应用**

基于网络数据模型，可以解决路径选择、设施布局优化、资源分配、空间相互作用和引力分析等问题。结合复杂网络的引力模型，可用于理解某点或区域的人流、物流和资金流的流动，典型的问题，如人们总是选择距离近、交通较为便捷的商场去购物，但可能更愿意去较远地方的注明医院去看病就医。

#### 四、时空数据模型

简称时空模型，主要用于表达地理现象或实体的特征或相互关系随时间变化的动态过程和静态结果。在时空数据模型中，空间、时间和属性构成了地理现象或对象的三个基本要素。现实世界中几乎所有对象都会在一定的时间尺度上发生变化，随着空间数据采集技术的不断提升，尤其是大数据技术的发展，可获得空间数据的时间特征越来越容易，时空数据模型的表达、管理和分析方法已经成为 GIS 领域的研究热点。同时，失控数据模型也是时态 GIS（TGIS）的核心内容。

#### 五、多维数据模型

多维数据模型一般指数据维度多于两个维度的三维数据模型或更多维度的数据模型。地理信息系统中的多维数据通常用于表达某种地理现象或实体的属性或相互关系在特定的区域内不仅随着时间变化，而且其变化还随着其他属性变化而发生改变的问题。

### 空间数据类型及其表示

#### 空间数据类型

地理信息中的数据来源和数据类型很多，概括起来主要有以下 4 种：

- 几何图形数据。来源于各种类型的地图和实测几何数据。几何图形数据不仅反映空间实体的地理位置，还要反映实体间的空间关系。
- 像素数据。主要来源于卫星遥感、航空遥感和摄影测量等
- 属性数据。来源于实测数据，文字报告，或地图中的各类符号说明，以及从遥感影像数据通过解释得到的信息等
- 元数据。对空间数据进行推理、分析和总结得到的关于数据的数据，如数据来源、数据权属、数据产生的时间、数据精度、数据分辨率、数据比例尺、地理空间参考基准、数据转换方法等。

#### 几何图形数据的表示方法

几何图形数据是空间数据的常用表示方法之一。这些不同类型的数据都可抽象表示为点线面体等基本的图形要素
![几何图形数据](/images/geometry/img3.png)

#### 几何图形数据的表示方法

- 点：点既可以是一个标识空间点状实体，如水塔，也可以是标记点，仅用于特征的标注和说明，或作为面域的内点用于标明该面域的属性，或是线的起点、终点或交点，则称为结点（node）。
- 线：具有相同属性点的轨迹，线的起点和终点表明了线的方向。道路、河流、地形线、区域边界等均属于线状地物可抽象为线。线上各点具有相同的公共属性并至少存在一个属性。当线连接两个结点时，也称作弧段（arc）或链（link）
- 面：是线包围的有界连续的具有相同属性值的面域，或称为多边形。多边形可以嵌套，被多边形包含的多边形称为岛。
- 体：体数据主要用于表示三维地理对象。例如三维的建筑物，三维道路等，均可以通过体要素表示。

空间的点、线、面、体可以按照一定的地理意义组成区域（region），有时称为一个覆盖（coverage），或数据平面（data plane）。各种专题图在 GIS 中都可以表示为一个数据平面。扩展至三维空间，可以通过点、线、面、体和体综合表示。

#### 空间数据类型的划分

在空间几何图形数据中，点是最为基本的几何图形要素，其他类型的几何图形都是基于点数据构建。因此，基本的几类几何图形数据之间可以实现相互转换。按照维度划分，一般而言，点属于 0 维的数据，线属于一维的数据，面则是属于二维的数据，体是三维数据。这是根据数据科学的标准对数据维度进行划分。
![空间数据类型的划分](/images/geometry/img1.png)

点与线

点数据使用坐标进行存储。在二维平面上，某点 P 可以存储为 P(x,y),如果点数据含有高程信息，则可以存储为 p(x,,y,z)。从这个意义上讲，前者属于二维点要素，后者则属于三维点要素。线要素实际上是由多个点连接后的结果。如果一条线上的所有节点都是二维点，则会构建二维线要素。如果都是三维节点，则会生成三维要素。三维线的构建本质上是由点的高程属性以及点的序列关系所决定的。
![点与线](/images/geometry/img4.png)

线面体

闭合的线可以构建面，如果面中包含三维的线，则可以构建三维矢量面。至少三条直线就可以构建一个面。基于多个面可以构建多面体。一般而言，封闭的多面体较为常用。如果 c、d 所示为基于面构建的不同多面体。在 c 中，面 A1、A2、A3、A4、A5 共同构建了一个封闭的五面体。
![线面体](/images/geometry/img5.png)

影像数据特征及其表示方法

影像数据又称为像素数据，是另外一种表示空间数据的常用表达方式。日常生活中的各类图片均属于像素数据，`像素数据的最小分割单元通常称之为像元。像素数据的基本特征包括像元的大小、像元空间分辨率与空间比例尺的关系、像元的取值方法等几个方面`。

像元大小

像元大小决定了影像数据所表达对象的详细程度，像元一般使用相同宽度和高度的方格表示。如下图所示，一个面对象可以采用不同像元大小的像素数据表示，像元越小，则表达越精细。
![像元](/images/geometry/img6.png)

影像数据的空间分辨率与比例尺

影像数据的空间分辨率是指像元大小所表示的在地面上覆盖面积的尺寸。因此，如果一个像元的覆盖面积为 5m\*5m，则分辨率为 5m。影像的分辨率越高，像元大小越小，从而详细程度越高，这和比例尺相反。比例尺越小，显示的细节越少。

像元的取值

像素单元取值是唯一的，但由于收到栅格大小的限制，栅格单元中可能会出现多个地物。在决定栅格单元值时应尽量保持其真实性，要确定该单元的属性取值，可根据需要选用取像元的中心点的值或是从像元的整体区域取值。
![像元的取值](/images/geometry/img7.png)

空间关系

空间关系式指地理空间实体之间相互作用的关系。空间关系主要有：

- 拓扑空间关系：用来描述实体间的相邻、联通、包含和相交等关系；
- 顺序空间关系：用于描述实体在地理空间上的排列顺序，如实体之间前后、上下、左右和东南西北等方位关系
- 度量关系：用于描述空间实体之间的距离远近等关系

对空间关系的描述是多种多样的，有定量的，也有定性的，有精确地，也有模糊的。各种空间关系的描述也非绝对独立，而是具有一定联系。对空间关系的描述和表达，是 GIS 能够进行复杂空间分析的重要原因。

空间拓扑关系

地图上的拓扑关系是指图形在保持连续状态下的变形（缩放、旋转和拉伸等，比如投影转换），但是图形关系不变的性质。地图上各种图形的形状、大小会随图形的变形而改变，但是图形要素间的邻接关系、关联关系、包含关系和连通关系保持不变。俗称的拓扑关系是绘在橡皮上的图形关系，或者说拓扑空间中不考虑距离函数。

空间拓扑关系
(1)邻接关系。空间图形中同类元素之间的拓扑关系。例如多边形之间的邻接关
系 P1,与 P2、P4，P4 与 P1、P2 等;结点之间的邻接关系 N1 与 N2、N3 等;
（2)关联关系。空间图形中不同类元素之间的拓扑关系。例如结点与弧段的关联
关系 N1 与 A1、A2、A3;N2 与 A1、A6、A7 等;弧段与多边形的关联关系 A1 与 P1，A2 与 P1
等；弧段与
结点的关联关系 A1 与 N1、N2，A2 与 N1、N3 等；多边形与弧段的拓扑关联关系 P1 与
A1、A2、A7，P4 与 A2、A3、A5、A4 等。
(3）包含关系。空间图形中不同类或同类但不同级元素之间的拓扑关系。例如多
边形 P4 中包含 P3。
(4)连通关系。空间图形中弧段之间的拓扑关系。例如 A1 与 A2、A6 和 A7 连通。

![空间拓扑关系](/images/geometry/img8.png)

空间实体间的拓扑关系

除了在逻辑上定义结点、弧段和多边形来描述图形要素的拓扑关系外，不同类型的空间实体间也存在着拓扑关系。分析点线面三种类型的空间实体，他们两两之间存在着分离、相邻、重合、包含或覆盖、相交 5 种可能得关系。

空间拓扑关系的意义

空间数据的拓扑关系，对数据处理和空间分析具有重要的意义：

- 拓扑关系能清楚的反映实体之间的逻辑结构关系，它比集合坐标关系有更大的稳定性，不随投影变换而变化。
- 利用拓扑关系有利于空间要素的查询，例如，某条铁路通过哪些地区，某县与哪些县邻接。又如分析某河流能为哪些地区的居民提供水源，某胡泊周围的土地类型以及对生物、栖息环境做出评价等。
- 可以根据拓扑关系重建地理实体。例如根据弧段构建多边形，实现道路的选取，进行最佳路径的选择等。

  因此再描述空间数据的逻辑模型时，通常将拓扑空间关系作为一个主要的内容

度量空间关系

度量空间关系主要指空间实体间的距离关系。也可以按照拓扑空间关系中建立点-点、点-线、点-面、线-线、线-面和面-面等不同组合来考察不同类型空间实体间的度量关系。距离的度量可以是定量的，如按欧几里得距离算出 A 实体距离 B 实体 500m，也可以应用于距离概念相关的概念如远近等进行定性的描述。与顺序空间关系类似，距离值随投影和几何变换而变化。建立点-点的度量关系容易，建立点-线和点-面的度量关系较难，而线-面、线-线和面-面的度量关系更为困难，涉及大量的判断和计算。在 GIS 中，一般也不明确描述度量空间关系。

顺序空间关系

顺序空间关系式基于空间实体在地理空间的分布，采用上下、左右、前后、东南西北等方向性名词来描述。同拓扑关系的形式化描述类似，也可以按点-点、点-线、点-面、线-线、线-面和面-面等多种组合来考察不同类型空间实体间的顺序关系。
![顺序空间关系](/images/geometry/img9.png)

## 空间数据结构

空间数据结构是指对空间数据逻辑模型描述的数据组织关系和编排方式的具体实现，对地理信息系统中数据存储、查询检索和应用分析等操作处理的效率有着至关重要的影响。

空间数据结构是地理信息系统沟通信息的桥梁，只有充分理解地理信息系统所采用的特定数据结构，才能正确有效地使用系统。
![](/images/geometry/img10.png)

数据结构即数据组织的形式，是适合于计算机存储、管理和处理的数据逻辑结构。`对空间数据则是地理实体的空间排列方式和相互关系的抽象描述`。

在地里信息系统中描述地理要素和地理现象的空间数据，主要包括空间位置、拓扑关系和属性三方面的内容。
![](/images/geometry/img11.png)
![](/images/geometry/img12.png)

### 矢量数据结构

矢量数据结构对矢量数据模型进行数据的组织。他通过记录实体坐标及其关系，尽可能精确地表示点、线、面等地理实体，坐标空间为连续空间，允许任意位置、长度和面积的精确定义。
![矢量数据结构](/images/geometry/img13.png)
![矢量数据结构](/images/geometry/img14.png)
矢量数据结构直接以几何空间坐标为基础，记录采样点坐标，通过这种数据组织方式，可以得到精美的地图。另外，该结构有着以下优势

- 可以对复杂数据以最小的数据冗余进行存贮
- 数据精度高
- 存储空间小等特点

`矢量数据结构是一种高效的图形数据结构。按其是否明确表示地理空间实体间的空间关系分为实体数据结构和拓扑数据结构两大类。`

**实体数据结构**

实体数据结构也称为 `spaghetti 数据结构`，是指构成多边形边界的各个线段，以多边形为单元进行组织。按照这种数据结构，边界坐标数据和多边形单元实体一一对应，各个多边形边界点都单独编码并记录坐标。

原始多边形 A、B、C、D，可以采用两种结构分别组织。
![实体数据结构](/images/geometry/img15.png)
第一种结构
![实体数据结构](/images/geometry/img16.png)
第二种结构
![实体数据结构](/images/geometry/img17.png)

实体数据结构的缺点

- 响铃多边形的公共边界要数字化两遍，造成数据冗余存储，可能导致输出的公共边界出现间隙或重叠。
- 缺少多边形的邻域信息和图形的拓扑关系
- 岛只作为一个单个图形，没有建立与外界多边形的联系

因此，实体式数据只适用于简单的系统，如计算机地图制图系统。
![多边形异常](/images/geometry/img18.png)

**拓扑数据结构**

拓扑关系是一种对空间结构关系进行明确定义的数学方法。具有拓扑关系的矢量数据结构就是拓扑数据结构。
拓扑数据结构没有固定的格式，还没有形成统一标准，但基本院系相同

他们的共同特点是: 点是相互独立的，点连成线，线构成面。每条线始于起始结点，止于终止结点，并与左右多边形相邻接。

拓扑数据结构最重要的特征是具有拓扑编辑功能；这种拓扑编辑功能，不但能够对数字化原始数据进行自动差错编辑，而且可以自动形成封闭的多边形边界，为由各个单独存储的弧段组成的各类多边形及建立空间数据库奠定基础。
拓扑空间数据结构主要有:`索引式、双重独立编码结构、链状双重独立编码结构`等

**索引式结构**采用树状索引以减少数据冗余并间接增加邻域信息，具体方法是对所有边界点进行数字化，将坐标对以顺序方式存储，由点索引与边界线号相联系，以线索引与各多边形想联系，形成树状索引结构。
![索引式结构](/images/geometry/img19.png)
![索引式结构](/images/geometry/img20.png)

**双重独立编码结构**简称 DIME 编码系统，他是以城市街道为编码主体，他的特点是采用了拓扑编码结构，这种结构最适合于城市信息系统。双重独立编码结构是对图上网状或面妆要锁的任何一条线段，用顺序的两点定义以及相邻多边形来予以定义。
![双重独立编码结构](/images/geometry/img21.png)
![双重独立编码结构](/images/geometry/img22.png)

**链状双重独立编码结构**是对 DIME 数据结构的一种改进。在 DIME 中，一条边只能用直线两端点的序号以及相邻的多边形来表示，而在链状数据结构中，将若干直线段合为一个弧段，每个弧段可以有许多中间点。

网络数据结构

网络数据结构由一组相连的边和交汇点以及连通性规则组成，用于表示现实世界中的网状线性系统。 网络数据结构是 GIS 数据建模和空间分析所必须得一种常用数据结构。采用网络结构进行建模的常见实体包括交通网络系统、电力系统、地下管网系统等

在 GIS 网络建模中，根据网络是否记录位置特征可以将其分为

- 几何网络
- 逻辑网络

![网络数据结构](/images/geometry/img23.png)
以上只是一个简单网络的几何数据结构，在实际应用中，网络建模要复杂得多。在较为复杂的网络中，可能需要考虑方向，还可能包含一级或多级的子节点和边，甚至还需要对转弯规则进行建模，如在道路建模中，某个道路交叉口只能左转弯，智斗需要再网络结构中添加响应的规则。对于简单网络数据结构，其编码方式同实体数据结构和拓扑数据结构的编码方式类似，但在复杂网络数据结构中，考虑的规则较多，其建模的形式也有所不同。

### 栅格数据结构

以规则栅格阵列表示空间对象的数据结构称为栅格数据结构。阵列中每个栅格单元上的数值表示控件对象的属性特征。即栅格阵列中每个单元的行列号确定位置，属性值表示空间 对象的类型、等级等特征。每个栅格单元只能存在一个值。
![栅格数据结构](/images/geometry/img24.png)
`栅格数据结构的显著特点是：属性明显，定位隐含，即数据直接记录属性的指针或属性本身，而所在位置则根据行列号转换为响应的坐标给出，也就是说定位是根据数据在数据集中的位置得到的`。

栅格数据的优缺点：

- 优点：数据结构简单、数据模拟方便
- 缺点：数据量大、难以建立实体间的拓扑关系，通过改变分辨率而减少数据量时精度和信息量同时受损等。

完全栅格数据结构

完全栅格数据结构也称编码，是将栅格看做一个数据矩阵，逐行逐个记录栅格单元的值。这是最简单最直接的一种栅格编码方式。通常这种编码为栅格文件或网格文件，他不采用任何压缩数据的处理。
完全栅格数据的组织有三种基本方式

- 基于像元
- 基于层
- 基于面域
  ![完全栅格数据结构](/images/geometry/img25.png)

压缩栅格数据结构
![压缩栅格数据结构](/images/geometry/img26.png)
![压缩栅格数据结构](/images/geometry/img27.png)
![压缩栅格数据结构](/images/geometry/img28.png)
线性四叉树

- 线性四叉树则只存储最后叶子结点的信息，包括叶节点的位置编码、属性或灰度值
- 线性四叉树地址码，通常采用十进制 Morton 码（MD 码）
  ![线性四叉树](/images/geometry/img29.png)
  ![MD码](/images/geometry/img30.png)
  ![MD码](/images/geometry/img31.png)
  ![MD码](/images/geometry/img32.png)
  ![MD码](/images/geometry/img33.png)

链码结构

链码数据结构首先采用弗里曼码对栅格中的线或多边形边界进行编码，然后再组织为链码结构
![链码结构](/images/geometry/img34.png)
特征码是指地物的特征码，表示地物的属性值。

映像与瓦片金字塔结构

影像金字塔结构用于图像编码和渐进式图像传输，是一种典型的分层数据结构形式，适合于栅格数据和影像数据的多分辨率组织，也是一种栅格数据或影像数据的有损压缩方式，由 M-金字塔，T-金字塔等。
![链码结构](/images/geometry/img35.png)
![链码结构](/images/geometry/img36.png)
无论由多少切片组成，其分辨率都保持不变，因此任何级别的请求都可以看到相同分辨率的切片服务。

#### 矢量数据和栅格数据结构的比较

![矢量数据和栅格数据结构的比较](/images/geometry/img37.png)
从上图来看，大体上矢量数据的优点恰好是栅格数据的缺点，反之亦然。

### 矢栅数据一体化数据结构

矢栅数据一体化数据结构将地理区域划分成多级网格：粗网格、基本网格、细分网格。

三级网格都采用线性四叉树编码用(M0、M1、M2)表示，其中 M0 表示点或线所用过的粗网格的 MD 码，是研究区的整体编码；M1 表示点或线所通过的基本网格的 Morton 码，也是研究区的整体编码；M2 表示点或线所通过的细分格网的 Morton 码，是基本栅格内的局部编码。
![矢栅数据一体化数据结构](/images/geometry/img38.png)
![矢栅数据一体化数据结构](/images/geometry/img39.png)

**矢量数据与栅格数据的融合与转换**

矢量数据到栅格数据的结构转换

矢量数据转换为栅格数据之前，需要线确定栅格像元的大小、像元值分配类型以及分配原则。

栅格像元的大小决定了数据的输出精度。像元值的分配类型和分配原则主要用于确定多个对象落入到同一个像元中时像元值的计算方式。
![矢栅数据一体化数据结构](/images/geometry/img40.png)

1. 线的转换 ： 八方向栅格化法：核心是对任一直线段如何转换成栅格数据
   ![矢栅数据一体化数据结构](/images/geometry/img41.png)
   为了避免转换后栅格像元线段可能出现间断现象，分两种情况判断
   ![矢栅数据一体化数据结构](/images/geometry/img42.png)

2. 面的转换：核心是将多边形矢量区域以及内部转换成栅格数据
   ![矢栅数据一体化数据结构](/images/geometry/img43.png)
   计算栅格图形每行中心线与面边界的交点，对交点进行排序、配对。并对本面域的栅格属性值去填充每对交点之间的栅格。

栅格数据到矢量数据的结构转换

二值化处理：在栅格图像灰度级的最大值和最小值之间选取一个阈值，当灰度级小于阈值时，取值为 0，当灰度级大于阈值时，取值为 1.
点的转换：设栅格点行列号为 I J，相应栅格中心点的矢量坐标为 P(X,Y)
![矢栅数据一体化数据结构](/images/geometry/img44.png)

线的转换：线状栅格图像往往具有一定的宽度，且往往宽窄不一，需要先细化处理，提取中轴线的基础上再矢量化，包括细化、跟踪和拓扑化过程。

通过 3*3 的像元窗口确定细化：凡是去掉后不会影响原栅格图像拓扑连通性的栅格都应该去掉。3*3 的像元阵列共有 2 的 8 次方种情况，经过旋转、去除相同情况，共有 51 种，其中，只有一部分是可以去掉中心点。
![矢栅数据一体化数据结构](/images/geometry/img45.png)
![矢栅数据一体化数据结构](/images/geometry/img46.png)
![矢栅数据一体化数据结构](/images/geometry/img47.png)

面的转换：面妆栅格数据向矢量数据转换只需要进行轮廓转换即可。

- 以面妆栅格影像边缘的一个像素为起点并记下按照点转换方法所得的(x,y)坐标
- 检测其 8 邻域，以找到下一个相邻的边缘像元作为新的起点，并记下其(x,y)坐标
- 重复该跟踪过程知道结束

**镶嵌数据结构**

- 以正方形和矩形单元进行地理空间划分的规则镶嵌数据模型，采用栅格数据结构进行数据的组织；
- Voronoi 多边形和 TIN 三角网采用专门的额数据结构进行数据组织。
  ![Voronoi数据结构](/images/geometry/img48.png)
  Voronoi 数据结构
  ![TIN三角网结构](/images/geometry/img49.png)
  TIN 三角网结构-以三角网为基本对象
  ![TIN三角网结构](/images/geometry/img50.png)
  TIN 三角网结构-以结点为基本对象
  **多维数据结构**
  现实世界呈现给我们的是一个三维甚至是多维的地理场景。例如、严格意义上将，温度不仅在二维空间分布上存在差异，随着海拔的省高，气温也会组件下降。这里就会涉及到三个维度，但是，三个维度只能表示某个时候任意位置的气温，而无法表示随时间的动态变化特征，这就需要添加第四个维度---时间维度，从而形成了一个四维数据模型。

如果以 Z 轴分别表示高程 H 和时间 T，则时空间可以用离散和连续两种方式表达
![TIN三角网结构](/images/geometry/img51.png)

八叉树数据结构

八叉树数据结构可以看成是二维栅格数据黄总的四叉树在三维空间的推广。该数据结构是将所要表示的三维空间 V 按 XYZ 三个方向从中间进行分割，把 V 分割成 8 个立方体；然后根据每个立方体中所含的目标来决定是否对立方体继续进行 8 等分的划分，一直划分到每个立方体被一个目标所充满，或是没有目标，或其大小已经成为预先定义的不可再分的体素为止。
![TIN三角网结构](/images/geometry/img52.png)
![TIN三角网结构](/images/geometry/img53.png)

三维边界表示法

通过指定定点位置、构成边的顶点以及构成面的边来表示三维物体的方法被称为三维边界表示法
![三维边界表示法](/images/geometry/img54.png)

## 空间数据库

### 数据和数据库

`数据`是描述事物的符号记录，可以是数字形式，也可以是文字、图形、图像、声音、语言等多种表现形式。人们收集并抽取出应用所需的大量数据后，将其保存起来以供进一步加工处理，抽取有用的信息。

`数据库`是长期存储在计算机内的、有组织的、可共享的数据集合。数据库中的数据按一定的数据模型组织、描述和存储，具有较小的冗余度、较高的数据独立性和易扩展性，并可为各种用户共享。

常用的数据模型：层次模型、网状模型、关系模型、面向对象模型。

其中 `层次模型和网状模型统称为非关系模型`。非关系模型的数据系统在 20 世纪 70 年代到 80 年代非常流行，在数据库系统产品中占据了主导地位，现在已逐渐被关系模型的数据库系统取代。
![三维边界表示法](/images/geometry/img55.png)

#### 层次数据库模型

![三维边界表示法](/images/geometry/img56.png)
他的特点是将数据组织成一对多关系的结构。层次结构采用关键字来访问其中每一层次的每一部分。层次数据库结构特别适用于文献目录、土壤分类、部门机构等分级数据的组织。

优点：层次模型中各数据之间构成一种依次的、从上到下的层次关系，层次清楚，数据存取、检索方便。

缺点：

- 不能表示多对多的联系，结构缺乏灵活性
- 在 GIS 中，不能顾及公共点、线数据共享和实体元素间的拓扑关系；
- 需要采用大量的索引文件
- 实体元素重复存储，导致大量的冗余数据

#### 网状数据库模型

网络模型用链接指令或指针来确定数据间的显式链接关系，是具有多对多类型的数据组织方式。
![三维边界表示法](/images/geometry/img57.png)

网状数据库模型的特点：采用双向指针来表示数据间的连接关系，可表示多对多关系

优点：

- 网络模型类似于拓扑数据模型，可表示相邻的图形特征
- 在复杂的拓扑结构中搜索，双向环路指针很有效
- 避免哦了数据冗余

缺点：

- 间接的指针占用大量存贮空间
- 数据更新时，指针也需要变化，其建立和维护困难

#### 关系数据库模型

关系数据库模型师以记录组货数据表的形式组织数据，以便于利用各种地理实体与属性之间的关系进行存储和变换，不分层也不指针，是建立空间数据和属性数据之间关系的一种非常有效的数据组织方式。
![关系数据库模型](/images/geometry/img58.png)

关系数据库模型的特点
他把数据的逻辑结构归结为满足一定条件的二维表中的元素，关系表通过共同的特征联系起来。

优点：

- 对实体描述具有一致性，不需指针
- 结构灵活，易于理解和维护
- 可以用不二罗就运算和数学运算来操作数据

缺点：

- 操作要求在文件中顺序查找满足特定关系的数据，当数据库庞大时，效率降低
- 模型扩充困难

#### 面向对象数据库模型

GIS 中的地物可根据国家分类标准货世纪情况划分类型。如一个大学 GIS 的对象可分为建筑物、道路、绿化等几类，地物类型的每一个大类又可以进一步分类，另一方面年，几种具有相同属性和操作的类型可总和为超类。
![关系数据库模型](/images/geometry/img59.png)

### 空间数据库

空间数据库（GeoDataBase）是某一区域内关于一定地理要素特征的数据集合，是地理信息系统在计算机物理存储介质存储的与应用相关的地理空间数据的总和，一般是以一系列特定结构的文件的形式组织在存储介质之上的。
![关系数据库模型](/images/geometry/img60.png)

`空间数据库的特点：数据量特别大、数据结构复杂、数据关系多样、数据应用广泛。`

空间数据库的组成：空间数据库的组成从类型上分有`栅格数据库和矢量数据库`两类。其中`栅格数据包括航空遥感影像数据和 DEM 数据`；`矢量数据则包括各种空间实体数据（图形和属性数据`）.

#### 空间数据库设计内容

数据库设计是指对于一个给定的应用环境，构造最优的数据库模式，简历数据库及其应用系统，使之能够有效的存储数据，满足各种用户的应用需求。

由于空间数据本身的特征，导致空间数据库的设计与传统数据库设计存在巨大的差异。良好的空间数据库设计，对于数据库的数据存储结构、存取效率等方面具有重要影响。因此对各 GIS 设计目标和方法有一个基本的了解至关重要。进行地理数据库设计，需要先确定要使用的数据专题，然后再指定各专题图层的内容和表现形式。

相比传统数据库，在空间数据库的设计阶段，主要包括以下几个方面的内容

- 选择数据模型与划分地理实体
- 确定数据实体属性与空间结构
- 实现丰富的地理实体行为
- 属性关系及完整性约束

#### 空间数据库设计步骤

空间数据库的设计是一个负责的过程。其设计步骤主要包括以下几个方面:

1. 确定业务需求与目标信息产品
2. 根据信息需求，确定主要数据专题
3. 指定比例范围以及每个数据专题在每个比例下的空间表示
4. 将各种表示形式分解为一个或多个地理数据集合
5. 为描述性的属性定义表格型数据库结构和行为
6. 定义数据集的空间行为、空间关系和完整性规则
7. 构建可用的原型，查看优化设计测试原型设计
8. 记录地理数据库设计

#### 空间数据的基本特征

- 空间特征
- 非结构化特征
- 空间关系特征
- 多尺度与多态性
- 分类编码特征
- 海量数据特征

由于空间数据存在非结构化特征、空间关系特征，使得通用数据库管理系统在管理空间数据时，面临较多问题:

1. GIS 需要一些复杂的图形功能，一般的 DBMS 不能支持
2. DBMS 一般都难以实现对空间数据的关联、连通、包含、叠加等基本操作
3. 地理信息表达复杂，表示搭那个地理实体需要多个文件、多条记录，一般的 DBMS 也难以支持、
4. 具有高度内部联系的 GIS 数据记录需要更复杂的安全性维护系统。一般的 DBMS 都难以保证
5. GIS 中空间数据记录是变长的（存储的坐标点的数目随控件对象的变化而变化），而一般数据库都只允许把记录的长度设定为固定长度

### 空间数据的组织

#### 空间数据的分层组织

将表示同一地理范围内总舵地理要素和地理现象的空间数据采用分层方式进行数据组织，这是一种起源于地图制图的空间数据组织方式，在分层数据组织中，图层咳根据地理事物或地理现象的分类，按照数据类型（矢量、栅格、影像等）、专题内容、要素几何类别（点、线、面）、时间次序等设定。
![关系数据库模型](/images/geometry/img61.png)
![关系数据库模型](/images/geometry/img62.png)
![关系数据库模型](/images/geometry/img63.png)

优点：

- 这种方式是目前颇为普遍的数据组织方法，方便使用者选择合适的数据，适合与栅格或矢量数据结构，目前大多数 GIS 软件采用这一方法。
  缺点
- 缺点是层与层之间的数据必须经过层叠置处理才能关联在一起，在叠置处理中，对栅格数据常需要大量存储空间来完成操作，而矢量数据则需大量的计算处理
- 同一图层内的图形数据的空间关系较为简单并易于处理，但不同图层之间的空间关系难以处理。

#### 空间数据的分块组织

当对大范围区域内众多类型空间数据进行存储和管理时，为了提高数据存储与管理的效率，可将空间数据所覆盖的区域范围分割为若干块或分区，按块分别进行空间数据的组织，块可以是规则的，也可以是不规则的。

优点：

- 分区式与分层可同时采用，并不冲突。
- 分区式也是目前大部分商业软件采用的方法，适合与栅格和矢量数据结构，在数据量大的系统中，分区方法可提高数据存取的效率。

缺点：图幅或区块间的衔接问题是分区法最大的困扰，尤其在空间数据查询、分析操作时更是这样。

#### 空间数据的无缝组织

为了克服空间数据分幅或分块组织时，导致对跨越多个图幅或分块地理要素的割裂或不一致，从而难以查询和分析等问题，在涉及大范围、海量空间数据的数据组织时，通常采用连续、无缝的数据组织形式，以满足用户任意和透明的访问和操作数据的要求。

无缝空间数据组织有 3 种实现途径：几何无缝、逻辑无缝和物理无缝的各分幅或分块表示的地理要素都转换到该坐标框架下并进行几何接边处理。
![关系数据库模型](/images/geometry/img64.png)

#### 多尺度空间数据组织

从理论上来说，在对现实世界的数字化表达中，不存在比例尺的概念，但从观察、理解及制图的角度来看，当涉及大范围区域时，往往需要从宏观到微观，以不同的层次细节来刻画地理要素，这就要求必须建立多尺度或多比例尺空间数据库。
![关系数据库模型](/images/geometry/img65.png)
目的是可视化需要和应对不同的需要。

#### 属性数据的组织

属性数据由关系数据库管理系统管理，但他的文件组织方式也要服从上述工作层、工作区和图库的要求，以便于图形文件协调工作，共同组成共工作区、工作层，并进行跨图幅操作。在不同的商业化软件中，属性文件组织方式各不相同。主要的 3 中方式如下：

1. 与工作层对应的组织方式
2. 与地物类对应的组织方式
3. 混合方式

### 数据的管理

#### 矢量数据的管理

1. 文件-关系数据库混合管理
   由于空间数据的非结构化特征，早起关系型数据库难以满足空间数据管理的要求。因此，传统 GIS 软件采用文件与关系数据库混合方式管理空间数据，比较典型的是 ArcInfo，有的系统也采用纯文件方式管理空间数据，如 MapInfo；即用文件系统管理几何图形数据，用商用关系型数据库管理属性数据，两者之间通过目标标识或内部链接吗进行链接
   ![关系数据库模型](/images/geometry/img66.png)

2. 全关系数据库混合管理
   全关系数据库管理方式下，图形数据与属性数据都采用现有的关系型数据库存储，使用关系数据库标准连接机制来进行空间数据与属性数据的链接。对于变长数据采用定长记录的数据表或者处理成二进制字段进行存储。
   ![关系数据库模型](/images/geometry/img67.png)

3. 对象-关系数据库管理
   由于直接采用通用的关系数据库管理系统的效率不高，而非结构化的空间数据又十分重要，所以许多数据库管理系统的软件商在关系数据库管理系统中进行扩展，是指能直接存储和管理非结构化的空间数据。如 Informix 和 Oracle 等都推出了空间数据管理的专用模块，定义了曹总点、线面等控件对象的 API 函数。这些函数，将各种中间对象的数据结构进行了预先的定义。

#### 栅格数据的管理

1. 文件管理方式
   目前大部分 GIS 软件和遥感图像处理软件都是采用文件方式来管理遥感影像数据。由于遥感影像数据库并不是仅仅包含图像数据本身，而且还包含大量的图像元数据信息（如图像类型、摄影日期、摄影比例尺等），遥感图像数据本身还具有多数据源、多时相等特点，另外，数据的安全性、并发控制和数据共享等都将文件管理无法应对。
   ![关系数据库模型](/images/geometry/img68.png)

2. 文件-数据库管理方式
   为了改进文件方式管理影像数据的效率，一种新的管理方式被提出来：文件+数据库管理方式。实施这种方式管理影像数据时，影像数据仍按照文件方式组织管理；在关系数据库中，每个文件都有唯一的标识号对应影像信息，如文件名字、存储路径等。

3. 关系数据库管理
   由于关系数据库发展成熟，具有良好的安全措施和数据恢复机制；目前关系数据库系统提供了存储复杂数据类型的能力，使利用关系数据库来管理影像数据成为可能。基于扩展关系数据库的影像数据库管理时将影像数据存储在二进制变长字段中，然后应用程序通过数据访问接口来访问数据库中的影像数据。同时影像数据的元数据信息存放在关系数据库的表中，二者可以进行无缝管理。

### 关系数据库管理的的点

- 所有数据集中存储，数据安全，易于共享
- 较方便管理多数据源和多失态的数据
- 支持事务处理和并发控制，有利于多用户的访问与共享
- 影像数据和元数据集成到一起，能方便地进行交互式查询
- 对 Client/Server 的分布式应用支持较好，网络性能和数据传输速度都有提高
- 影像数据访问只能通过数据库驱动结构访问，有利于数据的一致性和完整性控制，数据不会被随意移动、修改和删除
- 支持异构的网络模式，即应用程序和后台数据库服务器可以再不同操作系统平台下运行。现有商用数据库都有良好多的网络通信机制，本身能够实现异构网络的分布式计算，使得应用程序的开发相对简单化。

### 时空大数据的管理

#### 时空大数据的来源

随着计算机技术、物联网、移动通信以及遥感技术的进一步的发展和完善，人类进入了一个前所未有的数据大爆炸时代。许多与地理位置、时间相关的时空大数据在数据管理方面给传统的 GIS 数据管理带来了挑战和机遇，一些应对时空大数据管理的方法和技术应运而生，时空大数据来源于以下几个方面：

- 基础测绘数据与专题数据
- 遥感影像数据
- 导航定位数据
- 互联网以及物联网数据

#### 时空大数据的管理

时空大数据的存储管理，不能仅仅考虑或重点考虑数据存储层面的问题。必须从整个时空大数据平台入手展开顶层设计。既要考虑多源异构大数据的接入，组织、提取，又要考虑分析过程数据、分析结果数据的协调和组织。
![关系数据库模型](/images/geometry/img69.png)

#### 空间数据引擎

之前采用干洗数据库与稳健混合管理模式的传统 GIS 数据库系统技术，在应用上取得了一定的成功，但不得不部分的采用文件方式管理，总体上无法达到数据库技术冗余度、独立性等要求，用现代数据库技术统一存放和管理空间数据与属性数据是 GIS 发展的必然趋势。

#### 空间数据索引概述

索引是丢数据库表中一列或多列的值进行排序的一种结构，使用索引可以快速访问数据库表中的特定信息。

空间索引是指依据控件对象的位置和形状或控件对象之间的某种空间关系按照一定的顺序排列的一种数据结构，其中包括控件对象的概要信息，如对象的标识、外接矩形及其指向控件对象实体的指针。作为一种辅助性的空间数据结构，空间索引介于空间操作算法和控件对象之间。

1. 对象范围索引
   在记录每个空间实体的坐标时，记录包围每个空间实体的外接矩形的最大最小坐标。这样，在检索空间实体时，根据空间实体的最大最小范围，预先排除那些没有落入检索窗口内的空间实体，仅对那些外接矩形落在检索窗口的空间实体做进一步的判断，最后检索出那些真正落入窗口内的空间实体。
   ![关系数据库模型](/images/geometry/img70.png)
2. 网格索引
   网格型空间索引思路比较简单，容易理解和实现。其基本思想是将研究区域用横竖线条划分大小相等和不等的网格，记录每一个网格所包含的空间实体。当用户进行空间查询时，首先计算出用户查询对象所在格网，然后再改格网中快速查询所选空间实体，这样一来就大大地加速了空间索引的查询速度。
   ![关系数据库模型](/images/geometry/img71.png)
3. 四叉树空间索引
   四叉树作为一种有效的数据结构，不仅可以用来对栅格数据进行组织，他还可用于建立空间数据的索引。四叉树中的线性四叉树和层次四叉树都可以用于建立空间索引
   ![关系数据库模型](/images/geometry/img72.png)

## 空间数据采集与处理

### 数据源的分类

GIS 数据源比较丰富，类型多种多样，通常可以根据数据获取方式或表现形式进行分类。
![GIS数据源分类](/images/geometry/img73.png)
数据源特征
![数据源特征](/images/geometry/img74.png)

空间数据采集与处理的基本流程

不同的数据源，有不同的采集与处理方法，总体上讲，空间数据的采集与处理包含下面所示的基本内容
![数据源特征](/images/geometry/img75.png)

1. 数据源的选择
   地理信息系统管可用的数据源多种多样，进行选择时，应该注意从下面三个方面考虑

- 是否能够满足系统功能的要求
- 所选数据源是否已有使用经验
- 系统成本

2. 采集方法的确定

- 地图数据，扫描矢量化
- 遥感数据影像，摄影测量，遥感图像处理
- 实测数据，全站仪数据采集，GPS 测量等
- 统计数据，键盘输入，扫描仪输入等
- 共享数据，数据交换等
- 多媒体数据
- 文本资料数据。键盘直接输入

3. 数据的编辑和处理
   各种方法所采集的原始空间数据，都不可避免的存在着错误或者误差，属性数据在建库输入时，也难免会存在错误，所以对图形数据和属性数据进行一定的检查、编辑是很有必要的。要求不同，方法也不同，常用方法有：数学基础、数据结构的转换；图形拼接、拓扑生成；数据压缩。

4. 数据质量控制与评价
   无论是何种数据源，使用何种方法进行采集，都不可避免的存在各种类型的误差，而且误差会在数据处理以及系统的各个环节之中累计和传播，对于数据质量的控制和评价是系统有效运行的重要保障和系统分析结果可靠性的前提条件之一。
5. 数据入库
   数据入库就是按照空间数据管理的要求，把采集和处理的成果数据导入到空间数据库中。

空间数据采集

数据采集就是运用各种技术手段，通过各种渠道收集数据的过程。服务于地理信息系统的数据集工作包括两方面的内容：空间数据的采集和属性数据的采集。

- 空间数据采集的方法：野外数据采集、现有地图数字化、摄影测量方法、遥感图像处理方法等
- 属性数据包括采集的过程以及采集后的分类和编码，相应的采集方案：从相关部门的观测、测量数据、各类统计数据、专题调查数据、文件资料数据等渠道获取。此外，遥感图像解译也是属性数据的重要渠道。

野外数据采集
![数据源特征](/images/geometry/img76.png)
数字测记

数字侧记模式使用全站仪或者 GNSS RTK 在实地测定或计算地形、地物特征点的三维坐标，用一起内存器或联机通信的电子收包记录碎部点定位信息，用草图或简码记录其他绘图信息，在室内将测量数据传输到计算机，在数字测图软件的支持下，进行人机交互编辑与处理，得到 DLG、DEM 以及全要素地形图。

根据实地采集数据所用的设备不同，又可进一步分为 全站仪数据侧记模式和 GNSS RTK 数字侧记模式

电子平板测绘

电子平板测绘模式实际上是使用 “全站仪- 便携机-测图软件”在实地进行数据采集与编辑、制图的作业方式。

在该模式中，使用便携机的屏幕模拟测图平板，利用数字测图软件，在野外直接将全站仪测定的碎部点实时传输给便携机并展示绘制到屏幕上，一句测点的连接方式，进行地形、地物要素的矢量化编辑，从而实现测与会的同步，达到 所测即所得的目的。

地图数字化-手扶跟踪数字化
![数据源特征](/images/geometry/img77.png)

摄影测量方法-摄影测量原理

航测上规定当主轴线与铅垂线方向的夹角小于 3 度时为垂直摄影。摄影测量通常采用立体摄影测量方法采集某一地区空间数据，对统一地区同时摄取两张或多张重叠的相片，在室内的光学仪器上火计算机内恢复他们的摄影方位，重构地形 biu 凹面，即把野外的地形表面搬到室内进行观测。
![数据源特征](/images/geometry/img78.png)
航测上对立体覆盖的要求是当飞机沿一条航线飞行时相机拍摄的任意相邻两张像片的重叠度（航向重叠）不少于 55%-65%，在相邻航线上的两张相邻像片的旁向重叠应该保持在 30%。

数字摄影测量方法采集流程
![数据源特征](/images/geometry/img79.png)
遥感图像处理
![数据源特征](/images/geometry/img80.png)
时空大数据采集

定位导航时空大数据采集：目前，最为常见的交通大数据包括 城市出租车轨迹数据、共享单车和公共单车定位数据以及其他公共交通实时监测数据。主要包括车辆轨迹数据和手机信令基站定位数据。

手机信令基站定位数据

手机已经成为人们日常生活中必不可少的通信工具。实际上，手机就是一个传感器，它记录着每一个人每天的日常行为。通过手机信令数据，可以分析人口的迁徙，居民日常活动的呢过信息，不仅如此，厂商还可以通过人们的定位信息，模拟与预测全国范围内不同尺度的人口密度和人口迁徙

互联网大数据采集

基于网络爬虫技术的互联网大数据获取成为大数据采集、应用和分析的一大主流方向。主要包括基础网络时空大数据采集以及基于网页文本的地理信息采集。

物联网-传感器大数据采集

物联网技术是实现智慧城市的主要支撑技术。其目标是将人、物通过传感器互联，从而构建一个人和人、物和物以及人和物之间均相互联系的系统。物联网主要通过各种传感器实现。由于无论是静态的传感器还是动态移动的传感器，都与地理位置和时间强相关，因此，大多数物联网所产生的数据都属于时空大数据，因此也是 GIS 的主要数据源，主要有社会感知大数据采集以及自然环境感知大数据采集。

属性数据采集

- 属性数据包括调查报告、文件、统计数据、实验数据与野外调查的原始记录等，如人口数据、经济数据、土壤成分等
- 对于待输入的属性数据，若数据量较小，可通过键盘直接键入，若数量大，一般使用关系型数据库或文件、表格、数据库导入
- 对于要直接记录到栅格或矢量数据文件中的属性数据，则必须进行编码输入。

数据编辑

图形数据编辑

统建数据采集过程中，认为因素是造成图形数据错误的主要原因
![数据源特征](/images/geometry/img81.png)
图形数据编辑中经常出现的错误

- 伪结点
- 悬挂结点
- 碎屑多边形
- 不正规的多边形
- 规则的人为对象

其他图形数据错误包括遗漏某些实体、重复录入某些实体、图形定位错误等的检查一般可采用如下方法进行：

- 叠合比较法
- 目视检查法
- 逻辑检查法

图形数据编辑

对于检查出的错误，对图形数据编辑是通过向系统发布编辑命令用光标激活来完成的，编辑命令主要有增加数据、删除数据和修改数据三类。编辑的对象是点元、线元、面元记忆目标，编辑工作的完成主要利用 GIS 的图形编辑功能来完成。

属性数据编辑

属性数据校核包括两部分：

- 属性数据与空间数据是否正确关联，标识码是否唯一，不含空值
- 属性数据是否准确，属性数据的值是否超过其取值范围等。

属性数据错误检查

属性数据错误检查可通过以下方法完成：

首先可以利用逻辑检查，检查属性数据的值是否超过其取值范围，属性数据之间或属性数据与地理实体之间是否有换谬的组合。

把属性数据打印出来进行人工校对，这和校核图来检查空间数据准确性相似。

点线拓扑关系的建立

点线拓扑关系的建立方法有两种方案：一种是在图形采集和编辑中实时建立，此时有两个文件表，一个记录结点所关联的弧段，一个记录弧段两端点的结点、

第二种方案是在图形采集与编辑之后，系统自动建立拓扑关系。其基本思想与前面类似，在执行过程中逐渐建立弧段与起终结点和结点关联的弧段表。

数据编辑与拓扑关系

拓扑关系

点线拓扑关系的建立
![数据源特征](/images/geometry/img83.png)

多边形拓扑关系的建立

多边形有 3 终情况：

- 独立多边形，它与其他多边形没有共同边界，如独立房屋，这种多边形可以在数字化过程中直接生成，因为它仅涉及一条封闭的弧段。
- 具有公共边界的简单多边形，在数据采集时，仅输入了边界弧段数据，然后用一种算法自动将多边形的边界聚合起来，简历多边形文件
- 嵌套的多边形，除了要按第二种方法自动建立多边形外，还要考虑多边形内的多边形（也叫做岛）

以第二种情况为例，讨论多边形自动生成的步骤和方法：
1,。 节点匹配。以任一弧段的端点为圆心，以给定容差为半径，产生一个搜索圆，搜索落入该搜索圆内的其他弧段的端点，若有，则取这些端点坐标的平均值作为结点位置，并代替原来各弧段的端点坐标
![数据源特征](/images/geometry/img84.png)
建立结点-弧段拓扑关系。在结点匹配的基础上，对产生的结点进行编号，并产生两个文件表，一个记录结点所关联的弧段，另一个记录弧段两端的结点。
![数据源特征](/images/geometry/img85.png)
多边形的自动生成，实际上是指建立多边形与弧段的关系，并将弧段关联的左右多边形填入弧段文件中。简历多边形拓扑关系时，必须考虑弧段的方向性，即弧段沿起结点出发，到终结点结束，沿该弧段前进方向，将起关联的两个多边形定义为左多边形和右多边形。

建立多边形拓扑关系的算法：

- 假如从 A4 开始，其起结点为 N4，终结点为 N3，在结点 N3 上，连接的弧段
  分别为 A4、A6、A2，则后续弧段为 A6。
- 沿 A6 向前追踪，其下一结点为 N2,N2 连接的弧段为 A6、A5、A3，后续弧
  段为 A5，A5 的下一结点为 N4。
- 回到弧段追踪的起点，形成一个弧段号顺时针排列的闭合的多边形，该
  多边形一弧段的拓扑关系表建立完毕。在多边形建立过程中，将形成的
  多边形号逐步填入弧段一多边形关系表的左、右多边形内。

网络拓扑关系的建立

网络拓扑关系的建立主要是确定结点与弧段之间的拓扑关系，这一工作可以由 GIS 软件自动完成，其方法与建立多边形拓扑关系时相似，只是不需要建立多边形。但在一些特殊情况下，两条相互交叉的弧段在交点处不一定需要结点，如道路交通中的立交桥，两条相互交叉的弧段在交点处不一定需要节点，如道路交通中的立交桥，在平面上香蕉，但实际上不联通，这时需要手工修改，将在交叉处连通的结点删除。
![数据源特征](/images/geometry/img86.png)

数学基础变换

几何纠正

由于如下原因，使扫描得到的地形数据和遥感数据存在变形，必须加以纠正

- 地形图的实际尺寸发生变形
- 在扫描过程中，工作人员的操作会产生一定的误差，如扫描时地形图或遥感影像没有被压紧、产生斜置或扫描参数的设置不恰当的呢过
- 遥感影像本身就存在着几何变形
- 地图图幅的投影与其他资料的投影不同，或需要将遥感影像的中心投影或多中心投影转换为正射投影等
- 扫描时受扫描仪幅面大小的影响，有时需要将一副地形图或遥感影像分为几块扫描

地形图纠正

对地形图的纠正，一般采用四点纠正法活逐网格纠正法。

- 四点纠正法：一般是根据选定的数字变换函数，输入需要纠正地形图的图幅行列号、地形图的比例尺、图幅名称等，生成标准图廓，分别采集四个图廓控制点坐标来完成
- 逐网格纠正法：是在 4 点纠正法不能满足精度要求的情况下采用的。这种方法和四点纠正法的不通电就在于采样点数目的不同，他是逐方里网进行的，也就是说，对每一个方里网，都要采点。

遥感影像纠正

遥感影像纠正，一般选用和遥感影像比例尺相近的地形图或正射影像图作为变换标准，选用合适的变换函数，分别在要纠正的遥感影像和标准地形图或正射影像图上采集同名地物点。

坐标变换

坐标变换的实质是建立两个空间参考系之间点的一一对应关系。主要分为：投影变换、仿射变换、相似变换、橡皮拉伸。

投影变换
投影变换必须已知变换前后的两个空间参考的投影参数，然后利用投影公式的正解和烦解算法，推算变化前后两个空间参考系之间点的一一对应函数关系

- 投影变换是坐标变换中精度最高的变换方法
- 栅格单元尺寸大小、分辨率
- 栅格原点
- 栅格的倾角

仿射变换

仿射变换是在不同的方向上进行不同的压缩和扩张，可以将球变为椭球，将正方形变为平行四边形
![数据源特征](/images/geometry/img87.png)

相似变换

相似变换是由一个图形变换为另一个图形，在改变的过程中保持形状不变，大小可以更改。在二维变换中，常见的 3 种相似变换有：平移、旋转、缩放。

橡皮拉伸

橡皮拉伸通过坐标几何纠正来修正缺陷。主要针对几何变形，通常发生在原图上。他们可能由于在地图编绘中的配准缺陷、缺乏大地控制或其他各种原因产生。
![数据源特征](/images/geometry/img88.png)

如图所示，原图层（实心线）被纠正成更精确的目标（虚线）。类似于变换，位移关联点在橡皮伸缩中被用于确定要锁移动的位置。

栅格数据重采样

重采样是栅格数据胡空间分析中处理栅格分辨率匹配问题的常用数据处理的方法。进行空间分析时，用来分析的数据资料由于来源不同，经常要对栅格数据进行几何纠正、旋转、投影变换等处理，在这些处理过程中都会产生重采样问题。因此重采样在栅格数据的处理中占有重要地位。
![数据源特征](/images/geometry/img89.png)



最相邻像元法
![数据源特征](/images/geometry/img90.png)
双线性插值法
![数据源特征](/images/geometry/img91.png)
双三次卷积法
![数据源特征](/images/geometry/img92.png)

数据重构

数据重构主要包括数据结构的转换和数据格式的转换。通用的空间数据结构有栅格和矢量两种，在地理信息系统中，他们之间的相互转换是经常性的。 

GIS在其发展过程中，出现了很多研究机构和企业，他们所使用的数据格式往往不尽相同。为了实现相互之间的数据和资源共享，需要对数据格式进行转换。

数据结构转换包括两部分：`矢量数据向栅格数据的转换`和`栅格数据向矢量数据的转换`。

矢量数据栅格化

矢量数据的基本坐标是直角坐标x,y，其坐标原点一般取图的左下角。栅格数据的基本坐标时行和列（i，j），其坐标原点一般取图的西南角，两种数据变换时，令直角坐标x和y分别于行和列平行，按确定的栅格大小采样。

首先需要完成多边形边界线段的栅格化，然后，用面域属性值填充。矢量的面域向栅格转换又称为多边形填充，常用的多边形填充算法有：内部点扩散法、射线法、扫描线法。

- 从图幅西北角开始，按顺时针或逆时针方向，从起始点开始，根据8个相邻域进行搜索，依次跟踪相邻点，找出线段经过的栅格
- 将栅格i，j坐标变成直角坐标x，Y
- 生成拓扑关系，对于矢量表示的边界弧段，判断其于原图上各个多边形的空间关系，形成完整的拓扑结构，并建立于属性数据的联系。
- 去除多余点以及曲线圆滑：常用的算法有线性迭代法，分段三次多项式插值法、正轴抛物线平均加权法、斜抛物线平均加权法、样条函数插值法等
- ![数据源特征](/images/geometry/img93.png)

数据格式转换

数据交换模式

- 外部数据交换模式
- 直接数据访问模式
- 数据互操作模式
- 空间数据共享平台模式

数据格式的相互转换是目前可行的方法，数据转换可以分为三类：
- 分层和编码原则都不同的数据转换
- 分层不同，编码原则相同的数据转换
- 分层不同，编码方案完全一致的数据转换

空间数据格式转换的途径有：
- 外部文件交换方式
- 标准空间数据交换方式
- 空间数据互操作方式
- 基于语义数据转换方式

外部文件交换方式

![数据源特征](/images/geometry/img94.png)
标准空间数据交换方式
![数据源特征](/images/geometry/img95.png)

数据压缩

数据压缩是指从取得的数据集合中抽取一个子集，这个子集作为一个新的信息源，在规定的精度范围内最好的逼近原集合，而又取得尽可能大的压缩比。
- 栅格数据压缩技术有 游程编码、四叉树发等
- 矢量数据简化实际上是对原矢量坐标串中的多个矢量点根据线性形态，减少数据点，包括：线实体简化、双线中心线生成、多边形消融、多边形轮廓聚合。

间隔取点法：比较相邻晾特征点的距离与阈值的大小，确定是否保留或舍弃。
![数据源特征](/images/geometry/img96.png)
垂距和偏角法：利用曲线上顺序的3点Pn-1，Pn，Pn+1，将Pn-1，Pn+1相连，计算Pn到Pn+1的垂直距离或Pn-1Pn和PnPn+1直线的夹角，并规定限差，决定点的取舍。
![数据源特征](/images/geometry/img97.png)

分裂法

1. 把曲线首末两端点连城一条直线
2. 计算曲线上每一个点与直线的垂直距离。若所有这些距离均小于限差，则将直线两端点间的个点全部舍去
3. 若上一步条件不满足，则保留含有最大垂足距离的点，将原曲线分成梁端曲线，再递归的重复使用分裂法。
![数据源特征](/images/geometry/img98.png)

空间数据质量评价与控制
- 空间数据质量是指数据对特定用途的分析和操作的使用程度
- 空间数据质量与空间分辨率或制图比例尺相关。

相关概念
- 准确性（accuracy）即一个记录值与他的真实值之间的接近程度
- 数据的精密度（precision）对某一量的多次测量，各观测值的离散程度
- 分辨率（resolution）两个可测量数值之间最小的可辨识的差异。
- 比例尺（scale）地图上两个点间图面距离和他所表现的真实世界的距离之间的一个比值
- 误差（error）表示数据与其真实值之间的差异
- 不确定性（uncertainty）关于空间事物、现象的特征和过程不能被准确的确定的程度
- 偏差

准确性和数据的精密度一般可以合起来成为数据的精确度或者精度